KindEditor.plugin("baidumap",function(e){var a=this,t="baidumap",i=a.lang(t+"."),n=e.undef(a.mapWidth,558),o=e.undef(a.mapHeight,360);a.clickToolbar(t,function(){var d,r,s=e.undef(a.mapHtml,a.pluginsPath+"baidumap/index.html"),c='<div style="padding:10px 20px;"><div class="ke-header"><div class="ke-left">'+i.address+' <input type="text" id="kindeditor_plugin_map_address" name="address" value="" style="width:200px;margin-right:4px" /><span class="ke-button-outer"><button name="searchBtn" class="ke-button">'+i.search+'</button></span></div><div class="ke-right" style="margin-top:6px"><input type="checkbox" id="keInsertDynamicMap" name="insertDynamicMap" value="1" /> <label for="keInsertDynamicMap">'+i.insertDynamicMap+'</label></div><div class="ke-clearfix"></div></div><div class="ke-map" style="width:'+n+"px;height:"+o+'px;"></div></div>',p=a.createDialog({name:t,width:n+42,title:a.lang(t),body:c,yesBtn:{name:a.lang("yes"),click:function(e){var t=d.map,i=t.getCenter(),r=i.lng+","+i.lat,c=t.getZoom(),p=[u[0].checked?s:"//api.map.baidu.com/staticimage","?copyright=1","&center="+encodeURIComponent(r),"&zoom="+encodeURIComponent(c),"&width="+n,"&height="+o,"&markers="+encodeURIComponent(r),"&markerStyles="+encodeURIComponent("l")].join("");u[0].checked?a.insertHtml('<iframe src="'+p+'" frameborder="0" style="width:'+(n+2)+"px;height:"+(o+2)+'px;"></iframe>'):a.exec("insertimage",p),a.hideDialog().focus()}},beforeRemove:function(){r&&r.write(""),v.remove(),l.unbind(),h.unbind()}}),m=p.div,l=e('[name="address"]',m),h=e('[name="searchBtn"]',m),u=e('[name="insertDynamicMap"]',p.div),g=e._IE?' src="javascript:void(function(){'+encodeURIComponent("document.open();document.close();")+'}())"':"",v=e('<iframe class="ke-textarea" frameborder="0" style="width:100%;height:100%"'+g+"></iframe>");function f(){d=v[0].contentWindow,r=e.iframeDoc(v)}function y(){d&&d.search(l.val())}v.bind("load",function(){v.unbind("load"),e.IE?f():setTimeout(f,0)}),h.click(y),l.bind("keypress",function(e){13===e.keyCode&&y()}),e(".ke-map",m).append(v);var b=e.iframeDoc(v[0]);b.open(),b.write('<html><head><meta charset="utf-8" /><title></title><style>html,body {width:100%;height:100%;margin:0;padding:0;background:#FFF }</style><link rel="stylesheet" type="text/css" href="//api.map.baidu.com/res/13/bmap.css"/><script type="text/javascript" src="//api.map.baidu.com/getscript?v=1.3&ak=&services=&t=20200103072755"><\/script><script>var map,geocoder;function initialize(){map=new BMap.Map("map_canvas");var a=new BMap.Point(121.473704,31.230393);map.centerAndZoom(a,11),map.addControl(new BMap.NavigationControl),map.enableScrollWheelZoom(),(new BMap.Geocoder).getLocation(a,function(a){var e=[a.addressComponents.city].join("");parent.document.getElementById("kindeditor_plugin_map_address").value=e})}function search(a){map&&new BMap.LocalSearch(map,{renderOptions:{map:map,autoViewport:!0,selectFirstResult:!1}}).search(a)}<\/script></head><body onload="initialize();"><div id="map_canvas" style="width:100%; height:100%"></div><img src="//api.map.baidu.com/images/marker_red.png" style="position:fixed;top:50%;left:50%;margin-left:-13px;margin-top:-25px;"/></body></html>'),b.close()})});