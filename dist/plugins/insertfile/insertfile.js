var e,t,i,a,l,n,r,o={insertfile:"file",flash:"flash",media:"media",image:"image"};function d(e){var t,i="M1 14L23 14L23 16L1 16ZM1 18L23 18L23 20L1 20ZM1 22L23 22L23 24L1 24Z";return e>1?(t="M11 1L23 1L23 12L11 12Z",i+="M1 22L23 22L23 24L1 24ZM1 3L10 3L10 5L1 5ZM1 8L10 8L10 10L1 10Z"):e>0?(t="M1 1L13 1L13 12L1 12Z",i+="M14 3L23 3L23 5L14 5ZM14 8L23 8L23 10L14 10Z"):t="M6 1L18 1L18 12L6 12Z",'&nbsp;<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" style="vertical-align:middle"><path d="'+t+'" fill="#999"/><path d="'+i+'" fill="#bbb"/></svg>'}function s(s,u,g,c,h,m,v){var p=s.lang(g+"."),f="media"===g,b=!f&&"image"===g,k=v?v.clickFn:null;html='<div style="padding:20px;"><div class="ke-dialog-row"><label for="keUrl">'+p.url+'</label><input type="text" id="keUrl" name="url" style="width:205px;" /><input type="button" class="ke-upload-button" value="'+p.upload+'" /><span class="ke-button-outer" style="margin-left:5px;"><input type="button" class="ke-button" name="viewServer" value="'+p.viewServer+'" /></span></div>',html+="insertfile"===g?'<div class="ke-dialog-row"><label for="keTitle">'+p.title+'</label><input type="text" id="keTitle" name="title" style="width:335px;" /></div></div>':f||"flash"===g?'<div class="ke-dialog-row"><label for="keWidth">'+p.width+'</label><input type="text" id="keWidth" class="ke-input-number" name="width" maxlength="4" /> &nbsp;'+p.height+' &nbsp; <input type="text" id="keHeight" class="ke-input-number" name="height" maxlength="4" /> &nbsp;'+(f?'<input type="checkbox" id="keAutostart" name="autostart" style="vertical-align:middle"/><label for="keAutostart" style="width:auto">'+p.autostart+"</label>":"")+"</div>":'<div class="ke-dialog-row"><label>'+p.align+'</label><label title="'+p.defaultAlign+'"><input type="radio" name="align" class="ke-inline-block" value="" checked="checked" />'+d(0)+'</label><label title="'+p.leftAlign+'"><input type="radio" name="align" class="ke-inline-block" value="left" />'+d(1)+'</label><label title="'+p.rightAlign+'"><input type="radio" name="align" class="ke-inline-block" value="right" />'+d(2)+'</label></div><div class="ke-dialog-row"><label for="remoteTitle">'+p.imgTitle+'</label><input type="text" id="remoteTitle" name="title" style="width:200px;" /></div><div class="ke-dialog-row"><label for="remoteWidth">'+p.size+"</label>"+p.width+'&nbsp;<input type="text" id="remoteWidth" class="ke-input-number" name="width" maxlength="4" />&nbsp;'+p.height+'&nbsp;<input type="text" class="ke-input-number" name="height" maxlength="4" />&nbsp;<span title="'+p.keepAspect+'" class="ke-img-svg ke-img-svgon"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="18" height="18"><path d="M839.6 430.207h-72.59V261.461c0-141.567-114.732-256.3-256.3-256.3s-256.301 114.733-256.301 256.3v168.746H181.99c-34.919 0-63.301 28.383-63.301 63.301V955.71c0 16.858 6.708 32.855 18.577 44.896 11.87 11.87 28.039 18.578 44.896 18.578h658.47c16.857 0 32.855-6.709 44.896-18.578 11.869-11.869 18.577-28.038 18.577-44.896V493.508c0-16.857-6.708-33.198-18.75-45.067-12.556-11.87-28.898-18.406-45.755-18.234zm-170.981 0H352.8v-164.79c0-87.21 70.698-157.908 157.909-157.908s157.909 70.698 157.909 157.909v164.79zm0 0"/></svg></span><span title="'+p.resetSize+'" class="ke-img-svg"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="18" height="18"><path d="M232.4 362.7c14.7-27.3 33.2-52.2 55.4-74.4C317.1 259 351.2 236 389.1 220c39.2-16.6 80.9-25 123.9-25 39.3 0 77.5 7 113.8 20.9 35 13.4 67.2 32.8 95.6 57.6 52.8 46.1 88.8 108.1 102.7 176H955v-.2C923.8 233.1 737.8 67 513 67c-156.3 0-293.9 80.3-373.6 202L65 194v256h254l-86.6-87.3zM960 577H706l87.2 87.9c-18 33.2-41.9 63.3-70.9 88.6-28.4 24.8-60.6 44.2-95.6 57.6C590.5 825 552.3 832 513 832s-77.5-7-113.7-20.9c-35-13.4-67.2-32.8-95.6-57.6-52.8-46.1-88.9-108.1-102.7-176.1H71.1c0 .1 0 .3.1.4C102.3 794 288.3 960 513 960c156.1 0 293.4-80.1 373.2-201.3L960 833V577z"/></svg></span><a style="color:#70B4F1;cursor:pointer">clear</a></div>',html+="</div>";var w,L,y,x,M,U,T,A,F=s.createDialog({name:g,width:500,title:s.lang(g),body:html,yesBtn:{name:s.lang("yes"),click:function(e){var t=u.trim(D.val());if("http://"==t||u.invalidUrl(t))return alert(s.lang("invalidUrl")),void D[0].focus();var i=null;if("insertfile"===g){var a=w.val();""===u.trim(a)&&(a=t),k?k.call(s,t,a):i='<a class="ke-insertfile" href="'+t+'" data-ke-src="'+t+'" target="_blank">'+a+"</a>"}else{var l=L.val(),n=y.val();if(b){a=w.val();var r="";return x.each(function(){if(this.checked)return r=this.value,!1}),void k.call(s,t,a,l,n,0,r)}i=f?u.mediaImg({src:t,type:u.mediaType(t),width:l,height:n,autostart:A[0].checked?"true":"false",loop:"true"}):u.mediaImg({src:t,type:u.mediaType(".swf"),width:l,height:n,quality:"high"})}i&&s.insertHtml(i).hideDialog().focus()}},beforeRemove:function(){Z&&Z.unbind(),b&&(D.unbind(),L.unbind(),y.unbind(),M.unbind(),U.unbind(),T.unbind())}}),S=F.div,D=u('[name="url"]',S),Z=u('[name="viewServer"]',S),I=o[g],B=0;if(m){var H=u.uploadbutton({form:e,button:u(".ke-upload-button",S)[0],fieldName:i,url:u.addParam(t,"dir="+I),extraParams:a,afterUpload:function(e){if(F.hideLoading(),0===e.error){var t=e.url;l&&(t=u.formatUrl(t,"absolute")),s.afterUpload&&s.afterUpload.call(s,t,e,g),b&&!n?k.call(s,t,e.title,e.width,e.height,e.border,e.align):D.val(t)}else alert(e.message)},afterError:function(e){F.hideLoading(),s.errorDialog(e)}});H.fileBox.change(function(e){F.showLoading(s.lang("uploadLoading")),H.submit()})}else u(".ke-upload-button",S).remove(),B+=60;if(r?Z.click(function(e){s.loadPlugin("filemanager",function(){s.plugin.filemanagerDialog({viewType:"LIST",dirName:I,clickFn:function(e,t){s.dialogs.length>1&&(D.val(e),s.afterSelectFile&&s.afterSelectFile.call(s,e),s.hideDialog())}})})}):(Z.parent().remove(),Z=null,B+=70),B&&D.css("width",205+B+"px"),D.val(c),"insertfile"===g)w=u('[name="title"]',S).val(h);else if(f||"flash"===g){var z;if(f?(A=u('[name="autostart"]',S),z=s.plugin.getSelectedMedia()):z=s.plugin.getSelectedFlash(),L=u('[name="width"]',S),y=u('[name="height"]',S),z){var C=u.mediaAttrs(z.attr("data-ke-tag"));D.val(C.src),L.val(z[0].style.width||C.width||""),y.val(z[0].style.height||C.height||""),f&&(A[0].checked="true"===C.autostart)}}else{var P=u(".ke-img-svg",S);M=u(P[0]),U=u(P[1]),T=u("a",S),L=u('[name="width"]',S),y=u('[name="height"]',S),x=u('[name="align"]',S),w=u('[name="title"]',S).val(h);var W=!0,V=0,N=0,E=function(e,t){L.val(e),y.val(t),V=e,N=t},_=function(){var e=u('<img src="'+D.val()+'" />',document).css({position:"absolute",visibility:"hidden",top:"-1000px",left:0});e.bind("load",function(){E(e.width(),e.height()),e.remove()}),u(document.body).append(e)};M.click(function(){W?(W=!1,M.removeClass("ke-img-svgon")):(W=!0,M.addClass("ke-img-svgon"))}),L.bind("keyup",function(){W&&V>0&&y.val(Math.round(N/V*parseInt(this.value,10)))}),y.bind("keyup",function(){W&&N>0&&L.val(Math.round(V/N*parseInt(this.value,10)))}),T.click(function(){L.val(""),y.val("")}),D.change(_),U.click(_),w.val(h),E(u.undef(v.imageWidth,""),u.undef(v.imageHeight,""));var j=u.undef(v.imageAlign,"");x.each(function(){if(this.value===j)return this.checked=!0,!1})}D[0].focus(),D[0].select()}!function(){var o,d=["insertfile","flash","media","image"],u={insertfile:"allowFileUpload",flash:"allowFlashUpload",media:"allowMediaUpload",image:"allowImageUpload"};for(o=0;o<d.length;o++)!function(o){KindEditor.plugin(o,function(d){var g=this,c=d.undef(g[u[o]],!0);e=d.undef(g.forceIframeTransport,!1)||void 0===window.FormData,t=d.undef(g.uploadJson,g.basePath+"php/upload_json.php"),i=d.undef(g.filePostName,"imgFile"),a=d.undef(g.extraFileUploadParams,null),l=d.undef(g.formatUploadUrl,!0),n=d.undef(g.fillDescAfterUploadImage,!0),r=d.undef(g.allowFileManager,!1);var h=function(){s(g,d,o,"http://","",c,{})};"insertfile"===o?g.plugin.fileDialog=function(e){var t=d.undef(e.fileUrl,"http://"),i=d.undef(e.fileTitle,"");s(g,d,o,t,i,c,e)}:"flash"===o?g.plugin.flash={edit:h,remove:function(){g.plugin.getSelectedFlash().remove(),g.addBookmark()}}:"media"===o?g.plugin.media={edit:h,remove:function(){g.plugin.getSelectedMedia().remove(),g.addBookmark()}}:(g.plugin.imageDialog=function(e){var t=d.undef(e.imageUrl,"http://"),i=d.undef(e.imageTitle,""),a=c;"showLocal"in e&&!e.showLocal&&(a=!1),s(g,d,o,t,i,a,e)},g.plugin.image={edit:function(){var e=g.plugin.getSelectedImage();g.plugin.imageDialog({imageUrl:e?e.attr("data-ke-src"):"http://",imageWidth:e?e.attr("width"):"",imageHeight:e?e.attr("height"):"",imageTitle:e?e.attr("title"):"",imageAlign:e?e.attr("align"):"",clickFn:function(t,i,a,l,n,r){e?(e.attr("src",t),e.attr("data-ke-src",t),a?e.attr("width",a):e.removeAttr("width"),l?e.attr("height",l):e.removeAttr("height"),r?e.attr("align",r):e.removeAttr("align"),i?e.attr("title",i):e.removeAttr("title")):g.exec("insertimage",t,i,a,l,n,r),setTimeout(function(){g.hideDialog().focus()},0)}})},remove:function(){var e=g.plugin.getSelectedImage();"a"==e.parent().name&&(e=e.parent()),e.remove(),g.addBookmark()}}),g.clickToolbar(o,"image"===o?g.plugin.image.edit:h)})}(d[o])}();